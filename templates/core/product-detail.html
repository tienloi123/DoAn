{% extends 'partials/base.html' %}
{% load static %}
 {% block content %}
  <body id="product">
<nav aria-label="breadcrumb" class="w-100 float-left">
  <ol class="breadcrumb parallax justify-content-center" data-source-url="{% static 'img/banner/parallax.jpg' %}" style="background-image: url(&quot;img/banner/parallax.jpg&quot;); background-position: 50% 0.809717%;">
    <li class="breadcrumb-item"><a href="#">Home</a></li>
    <li class="breadcrumb-item active" aria-current="page">Shop</li>
  </ol>

</nav>
	<div class="product-deatils-section float-left w-100">
		<div class="container">
			<div class="row">
				<div class="left-columm col-lg-5 col-md-5">
					<div class="product-large-image tab-content">
						<div class="tab-pane active" id="product-01" role="tabpanel" aria-labelledby="product-tab-01">

							<div class="single-img img-full">
								<a href="img/products/01.jpg"><img src="{{p.image.url}}" class="img-fluid zoomImg" alt=""></a>
							</div>

						</div>
						{% for p in p_image %}
						<div class="tab-pane" id="product-02" role="tabpanel" aria-labelledby="product-tab-02">
							<div class="single-img">
								<a href=""><img src="{{p.images.url}}" class="img-fluid" alt=""></a>
							</div>
						</div>
						{% endfor %}
					</div>
					<div class="default small-image-list float-left w-100">
                                <div class="nav-add small-image-slider-single-product-tabstyle-3 owl-carousel" role="tablist">
                                    <div class="single-small-image img-full">
                                        <a data-toggle="tab" id="product-tab-01" href="#product-01" class="img active"><img src="{{p.image.url}}" class="img-fluid" alt=""></a>
                                    </div>
									{% for p in p_image %}
                                    <div class="single-small-image img-full">
                                        <a data-toggle="tab" id="product-tab-02" href="#product-02" class="img"><img src="{{p.images.url}}" class="img-fluid" alt=""></a>
                                    </div>
                                    {% endfor %}
                                </div>
                            </div>

				</div>
				<div class="right-columm col-lg-7 col-md-7">
					<div class="product-information">

<h4 class="product-title text-capitalize float-left w-100">
    <a href="product-details.html" class="float-left w-100">{{ p.title }}</a>
	{{average_rating|floatformat:1}} out of 5 ⭐
</h4>
<span style="display: inline-block; vertical-align: middle; background-color: pink; padding: 8px; border-radius: 10px; font-size: 14px;">-{{ p.get_precentage|floatformat:0 }}%</span>



					<div class="rating">
											</div>
													<div class="old-price" style="text-decoration: line-through;">Old Price: ${{ p.old_price }}</div>
													<div id="current-product-price-{{ p.id }}"><strong>Price: ${{ p.price }}</strong></div>




											<div class="product-variants float-left w-100">

						<div class="color-option d-flex align-items-center">
                                        <h5>color :</h5>
                                        <ul class="color-categories">
                                            <li class="active">
                                                <a class="tt-pink" href="#" title="Pink"></a>
                                            </li>
                                            <li>
                                                <a class="tt-blue" href="#" title="Blue"></a>
                                            </li>
                                            <li>
                                                <a class="tt-yellow" href="#" title="Yellow"></a>
                                            </li>
                                        </ul>
                                    </div>
					</div>
											<div class="btn-cart d-flex align-items-center float-left w-100">
						<h5>qty:</h5>

						<input value="1" type="number" min="1" max="{{ p.stock_count }}" id="product-quantity" name="" class="w-25 mb-10 product-quantity-{{ p.id }}"><br>
												<h5 id="stock-count"> {{p.stock_count}} items in stock</h5>
												<div class="product_extra-link2">
							<input type="hidden" value="{{ p.stock_count }}"  class="product-stock-{{ p.id }}">
							<input type="hidden" value="{{ p.pid }}"  class="product-pid-{{ p.id }}">
							<input type="hidden" value="{{ p.image.url }}"  class="product-image-{{ p.id }}  product-item-image" id="productImage">
							<input type="hidden" value="{{ p.price }}" id="product-price">
							<input type="hidden" value="{{ p.id }}"  class="product-id-{{ p.id }}">
							<input type="hidden" value="{{ p.title }}"  class="product-title-{{ p.id }}">


					</div>


				</div>
						<div>
        <button type="submit" class="add-to-cart-btn-btn-btn" style="font-size:16px" data-index="{{ p.id }}" id="add-to-cart-btn-btn-btn">
            <i class="material-icons" style="color:red;font-size:36px">shopping_cart</i>
            <span><strong>Add to cart</strong></span>
        </button>

    <button style='font-size:16px; margin-left:130px' id="glass_try"><i class='fas fa-camera-retro' style='font-size:36px; color:blue'></i><strong> Try on</strong></button>
</div>




						<!-- Sử dụng CDN -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet">

			</div>
		</div>
	</div>
	<div class="product-tab-area float-left w-100">
	<div class="container">
					<div class="tabs">
					<ul class="nav nav-tabs justify-content-start">
						<li class="nav-item"><a class="nav-link active" data-toggle="tab" href="#product-tab1" id="tab1"><div class="tab-title">Description</div></a></li>
						<li class="nav-item"><a class="nav-link" data-toggle="tab" href="#product-tab2" id="tab2"><div class="tab-title">Reviews ({{ reviews.count }})</div></a></li>
					</ul>
				</div>
					<div class="tab-content float-left w-100">
					  <div class="tab-pane active" id="product-tab1" role="tabpanel" aria-labelledby="tab1">
						  <div class="description">
							  {{p.description}}
						  </div>
					  </div>
					  <div class="tab-pane" id="product-tab2" role="tabpanel" aria-labelledby="tab2">
					  	<div class="comment-list reviews-tab  float-left w-100">



							<div class="ttreview-tab float-left w-100 p-30">
								<h1 style="font-size: 2em;">{{average_rating|floatformat:1}} out of 5 ⭐</h1>
								<br>
							  <h2 class="mb-30" >Customer Reviews </h2>



							<div class="comment-list">
								{% for r in reviews %}

								<div class="single-comment justify-content-between d-flex mb-30">
									<div class="user justify-content-between d-flex">
										<div class="thumb text-center">
											<img style="width: 50px; height:50px" src="https://png.pngtree.com/png-clipart/20200701/original/pngtree-black-default-avatar-png-image_5407174.jpg">
											<a href="#" class="font-heading text-brand">{{r.user.username|title}}</a>
										</div>
										<div class="desc">
											<div class="d-flex justify-content-between mb-10">
												<div class="d-flex align-items-center">
													<span class="font-xs text-muted">{{r.date|date:"d M, Y"}}</span>
												</div>
												<div>
													{% for star in "01234" %}
														{% if star|add:1 <= r.rating %}
															<span>⭐</span>
														{% else %}
															<span>✰</span>
														{% endif %}
													{% endfor %}
												</div>
											</div>
											<p class="mb-10">{{r.review}}</p>
										</div>

									</div>

								</div>
								{% endfor %}
							</div>
						</div>


							<div class="comment-form">
								<h2 class="mb-15 add-review">Add a review</h2>
								<strong class="text-success" id="review-res"></strong>
								<div class="row">
									<div class="col-lg-8 col-md-12">
										<form class="form-contact comment_form hide-comment-form" action="{% url 'core:ajax-add-review' p.id %}" id="commentForm" method="POST">
											{% csrf_token %}
											<div class="row" >
												<div class="col-12">
													<div class="form-group" style="background-color: grey;width: 270px;">
														{{review_form.review}}
													</div>
												</div>
												<div class="col-12">
													<div class="form-group">
														{{review_form.rating}}
													</div>
												</div>
											</div>
											<input type="button" class="btn btn-primary submit" value="Submit Review" onclick="submitReview(event)">
										</form>
									</div>
								</div>
							</div>
						</div>
					</div>
					</div>
	</div>
	</div>
	</div>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
	function submitReview(event) {
        // Ngăn chặn việc gửi biểu mẫu mặc định
        event.preventDefault();
        // Tuần tự hóa dữ liệu biểu mẫu
        var formData = $('#commentForm').serialize();
        // Gửi yêu cầu AJAX
    $.ajax({
        type: 'POST',
        url: $('#commentForm').attr('action'),
        data: formData,
        success: function(res){
			console.log("comment saved to DB...");
		// Tạo đối tượng Date
		var dt = new Date();
		// Lấy ngày tháng
		var day = dt.getDate();
		// Lấy tên tháng (index từ 0)
		var month = dt.getMonth();
		// Lấy năm
		var year = dt.getFullYear();
		// Chuyển đổi tên tháng từ index sang tên đầy đủ
		var monthName = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'][month];
		// Tạo chuỗi thời gian
		var time = day + ' ' + monthName + ', ' + year;

    if(res.bool == true){
        $("#review-res").html("Review Added successfully")
        $(".hide-comment-form").hide()
        $(".add-review").hide()

        let _html = '<div class="single-comment justify-content-between d-flex mb-30">'
        _html += '<div class="user justify-content-between d-flex">';
        _html += '<div class="thumb text-center">'
        _html += '<img src="">';
        _html += '<a href="#" class="font-heading text-brand">'+ res.context.user +'</a>';
        _html += '</div>';
        _html += '<div class="desc">';
        _html += '<div class="d-flex justify-content-between mb-10">';
        _html += '<div class="d-flex align-items-center">';
        _html += '<span class="font-xs text-muted">'+ time +'</span>';
        _html += '</div>';
        for(let i = 1; i <= res.context.rating; i++){
			_html += '<i class="fas fa-star text-warning"></i>';
		}
        _html += '</div>';
        _html += '<p class="mb-10">'+ res.context.review +'</p>';
        _html += '</div>';
        _html += '</div>';
        _html += '</div>';

        $(".comment-list").prepend(_html);
        }
    }
    });
}

</script>
	<div id="product-accessories" class="product-accessories my-40 w-100 float-left">
			<div class="container">
					<div class="row">
							<div class="tt-title d-inline-block float-none w-100 text-center">You might also like</div>
							<div class="product-accessories-content products grid owl-carousel">
								{% for p in products %}
							<div class="product-layouts">
								<div class="product-thumb">
									<div class="image zoom">
										<a href="product-details.html">
											<img src="{{ p.image.url }}" alt="01" style="width: 300px; height: 300px; object-fit: cover; border-radius: 50%"/>

											<img src="{% static 'img/products/kinh.jpeg' %}" alt="02" class="second_image img-responsive" style="width: 300px; height: 300px; object-fit: cover; border-radius: 50%"/>										</a>									</div>
									<div class="thumb-description">
										<div class="caption">
											<h4 class="product-title text-capitalize"><a href="product-details.html">{{p.title}}</a></h4>
										</div>




										<div class="price">
											<div class="currunt-product-price">${{p.price}}</div>
											<div class="old-price">${{p.old_price}}</div>
										</div>
										<div class="button-wrapper">
										<div class="button-group text-center">
												<button type="submit" id="add-to-cart" data-target="#cart-pop" data-toggle="modal"><i class="material-icons">shopping_cart</i><span>Add to cart</span></button>
												<a href="wishlist.html" class="btn btn-primary btn-wishlist"><i class="material-icons">favorite</i><span>wishlist</span></a>
												<button type="button" class="btn btn-primary btn-compare"><i class="material-icons">equalizer</i><span>Compare</span></button>
												<button type="button" class="btn btn-primary btn-quickview"  data-toggle="modal" data-target="#product_view"><i class="material-icons">visibility</i><span>Quick View</span></button>
											</div>
											</div>
									</div>
								</div>
							</div>
								{% endfor %}

							</div>
					</div>
			</div>
			</div>





  <!-- Register modal -->
  <div class="modal fade" id="modalRegisterForm" tabindex="-1" role="dialog" aria-hidden="true">
  <div class="modal-dialog" role="document">

    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-medium text-left">Sign up</h4>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-4">
          <input type="text" id="RegisterForm-name" class="form-control validate" placeholder="Your name">
        </div>
        <div class="md-form mb-4">
          <input type="email" id="RegisterForm-email" class="form-control validate" placeholder="Your email">
        </div>
        <div class="md-form mb-4">
          <input type="password" id="RegisterForm-pass" class="form-control validate" placeholder="Your password">
        </div>
		<div class="checkbox-link d-flex justify-content-between">
		<div class="left-col">
			<input id="remember-me" type="checkbox"><label for="remember_me">Remember Me</label>
		</div>
		<div class="right-col"><a href="#">Forget Password?</a></div>
	</div>
      </div>

      <div class="modal-footer d-flex justify-content-center">
        <button class="btn btn-primary">Sign up</button>
      </div>
    </div>
  </div>
</div>

<!-- Login modal -->
<div class="modal fade" id="modalLoginForm" tabindex="-1" role="dialog" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-medium text-left">Sign in</h4>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-4">
          <input type="text" id="LoginForm-name" class="form-control validate" placeholder="Your name">
        </div>
        <div class="md-form mb-4">
          <input type="password" id="LoginForm-pass" class="form-control validate" placeholder="Your password">
        </div>
		<div class="checkbox-link d-flex justify-content-between">
		<div class="left-col">
			<input type="checkbox" id="remember_me"><label for="remember_me">Remember Me</label>
		</div>
		<div class="right-col"><a href="#">Forget Password?</a></div>
	</div>
      </div>

      <div class="modal-footer d-flex justify-content-center">
        <button class="btn btn-primary">Sign in</button>
      </div>
    </div>
  </div>
</div>

<!-- product_view modal -->
<div class="modal fade product_view" id="product_view" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog">
	<div class="modal-content">
		<div class="modal-header">
			 <h4 class="modal-title w-100w-100w-100 font-weight-bold d-none">Quick view</h4>
			<button type="button" class="close" data-dismiss="modal" aria-label="Close">
	  <span aria-hidden="true">×</span>
	</button>
		</div>
		<div class="modal-body">
			<div class="row">
				<div class="col-md-6 left-columm">
						<div class="product-large-image tab-content">
						<div class="tab-pane active" id="product-1" role="tabpanel" aria-labelledby="product-tab-1">
							<div class="single-img img-full">
								<a href="img/products/01.jpg"><img src="img/products/01.jpg" class="img-fluid" alt=""></a>
							</div>
						</div>
						<div class="tab-pane" id="product-2" role="tabpanel" aria-labelledby="product-tab-2">
							<div class="single-img">
								<a href="img/products/02.jpg"><img src="img/products/02.jpg" class="img-fluid" alt=""></a>
							</div>
						</div>
						<div class="tab-pane" id="product-3" role="tabpanel" aria-labelledby="product-tab-3">
							<div class="single-img">
								<a href="img/products/03.jpg"><img src="img/products/03.jpg" class="img-fluid" alt=""></a>
							</div>
						</div>
						<div class="tab-pane" id="product-4" role="tabpanel" aria-labelledby="product-tab-4">
							<div class="single-img">
								<a href="img/products/04.jpg"><img src="img/products/04.jpg" class="img-fluid" alt=""></a>
							</div>
						</div>
						<div class="tab-pane" id="product-5" role="tabpanel" aria-labelledby="product-tab-5">
							<div class="single-img">
								<a href="img/products/05.jpg"><img src="img/products/05.jpg" class="img-fluid" alt=""></a>
							</div>
						</div>
				</div>
				<div class="small-image-list float-left w-100">
                                <div class="nav-add small-image-slider-single-product-tabstyle-3 owl-carousel" role="tablist">
                                    <div class="single-small-image img-full">
                                        <a data-toggle="tab" id="product-tab-1" href="#product-1" class="img active"><img src="img/products/01.jpg" class="img-fluid" alt=""></a>
                                    </div>
                                    <div class="single-small-image img-full">
                                        <a data-toggle="tab" id="product-tab-2" href="#product-2" class="img"><img src="img/products/02.jpg" class="img-fluid" alt=""></a>
                                    </div>
                                    <div class="single-small-image img-full">
                                        <a data-toggle="tab" id="product-tab-3" href="#product-3" class="img"><img src="img/products/03.jpg" class="img-fluid" alt=""></a>
                                    </div>
                                    <div class="single-small-image img-full">
                                        <a data-toggle="tab" id="product-tab-4" href="#product-4" class="img"><img src="img/products/04.jpg" class="img-fluid" alt=""></a>
                                    </div>
                                    <div class="single-small-image img-full">
                                        <a data-toggle="tab" id="product-tab-5" href="#product-5" class="img"><img src="img/products/05.jpg" class="img-fluid" alt=""></a>
                                    </div>
                                </div>
                            </div>
				</div>
				<div class="col-md-6 product_content">
					<h4 class="product-title text-capitalize">aliquam quaerat voluptatem</h4>

					<div class="rating">

					<div class="product-ratings d-inline-block align-middle">
																				<span class="fa fa-stack"><i class="material-icons">star</i></span>
									   <span class="fa fa-stack"><i class="material-icons">star</i></span>
									   <span class="fa fa-stack"><i class="material-icons">star</i></span>
									   <span class="fa fa-stack"><i class="material-icons off">star</i></span>
									   <span class="fa fa-stack"><i class="material-icons off">star</i></span>			</div>							</div>
					<span class="description float-left w-100">Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book.</span>
					<h3 class="price float-left w-100"><span class="regular-price align-middle">$75.00</span><span class="old-price align-middle">$60.00</span></h3>

					<div class="product-variants float-left w-100">
						<div class="col-md-4 col-sm-6 col-xs-12 size-options d-flex align-items-center">
											<h5>Size:</h5>

								<select class="form-control" name="select">
											<option value="" selected="">Size</option>
											<option value="black">Medium</option>
											<option value="white">Large</option>
											<option value="gold">Small</option>
											<option value="rose gold">Extra large</option>
								</select>
						</div>
						<div class="color-option d-flex align-items-center">
                                        <h5>color :</h5>
                                        <ul class="color-categories">
                                            <li class="active">
                                                <a class="tt-pink" href="#" title="Pink"></a>
                                            </li>
                                            <li>
                                                <a class="tt-blue" href="#" title="Blue"></a>
                                            </li>
                                            <li>
                                                <a class="tt-yellow" href="#" title="Yellow"></a>
                                            </li>
                                        </ul>
                                    </div>
					</div>
					<div class="btn-cart d-flex align-items-center float-left w-100">
						<h5>qty:</h5>
						<input value="1" type="number">
						<button type="submit" class="btn btn-primary" id="add"><i class="material-icons">shopping_cart</i> Add To Cart</button>
					</div>
				</div>

			</div>
		</div>
	</div>
</div>
</div>

  <!-- cart-pop modal -->
<div class="modal fade" id="cart-pop" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog">
	<div class="modal-content">
		<div class="modal-header alert-success">
			 <h4 class="modal-title w-100w-100w-100">Product successfully added to your shopping cart</h4>
			<button type="button" class="close" data-dismiss="modal" aria-label="Close">
	  <span aria-hidden="true">×</span>
	</button>
		</div>
		<div class="modal-body">
			<div class="row">
			<div class="col-md-6 divide-right">
			<div class="row">
				<div class="col-md-5 col-xs-4 product-img float-left">
					<img src="img/products/01.jpg" class="img-responsive" alt="01">
				</div>
				<div class="col-md-7 col-xs-8 product-desc float-left">
					<h4 class="product-title text-capitalize">aliquam quaerat voluptatem</h4>
					<div class="rating">
					<div class="product-ratings d-inline-block align-middle">
					<span class="fa fa-stack"><i class="material-icons">star</i></span>
				   <span class="fa fa-stack"><i class="material-icons">star</i></span>
				   <span class="fa fa-stack"><i class="material-icons">star</i></span>
				   <span class="fa fa-stack"><i class="material-icons off">star</i></span>
				   <span class="fa fa-stack"><i class="material-icons off">star</i></span></div></div>
					<h3 class="price float-left w-100"><span class="regular-price align-middle">$75.00</span><span class="old-price align-middle">$60.00</span></h3>
				</div>
			</div>
			</div>
				<div class="col-md-6 divide-left">
					<p class="cart-products-count">There are 2 items in your cart.</p>
					<p class="total-products float-left w-100">
						<strong>Total products:</strong> $150.00
					</p>
					<p class="shipping float-left w-100">
						<strong>Total shipping:</strong> free
					</p>
					<p class="total-price float-left w-100">
						<strong>Total:</strong> $150.00(tax incl.)
					</p>
					<div class="cart-content-btn float-left w-100">
					<form action="#">
                      <input class="btn pull-right mt_10 btn-primary" value="Continue shopping" type="submit">
                    </form>
					<form action="checkout_page.html">
                      <input class="btn pull-right mt_10 btn-secondary" value="Proceed to checkout" type="submit">
                    </form>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>
</div>

<div class="compare-wrapper float-left w-100">
	<div class="compare-inner d-flex align-items-center p-20">
		<span class="close"><i class='material-icons'>
  close
</i></span>
		<div class="col-sm-3 float-left d-flex align-items-center flex-column">
		<h2>compare products</h2>
		<div class="compare-btn">show all</div>
		</div>
		<div class="col-sm-9 d-flex float-left align-items-center">
			<div class="compare-close-btn"></div>
			<div class="compare-products d-flex col-sm-5">
			<div class="row">
				<div class="single-item col-sm-4">
					<div class="remove"></div>
					<div class="image"><img src="img/products/01.jpg" class="img-fluid" alt=""></div>
				</div>
				<div class="single-item col-sm-4">
					<div class="remove"></div>
					<div class="image"><img src="img/products/02.jpg" class="img-fluid" alt=""></div>
				</div>
				<div class="single-item col-sm-4">
					<div class="remove"></div>
					<div class="image"><img src="img/products/03.jpg" class="img-fluid" alt=""></div>
				</div>
			</div>
			</div>
			<div class="buttons col-sm-2">
				<div class="clear-btn btn btn-primary float-left w-100 mb-15">clear</div>
				<div class="compare-btn btn btn-primary float-left w-100">compare</div>
			</div>
		</div>
	</div>
</div>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script>
                                    $(document).ready(function(){
                                        $(".add-to-cart-btn-btn-btn").on("click", function(){
                                            event.preventDefault(); // Ngăn chặn sự kiện click lan ra
                                            let this_val = $(this);
                                            let index = this_val.attr("data-index");

                                            let quantity = $(".product-quantity-" + index).val();
                                            let product_title = $(".product-title-" + index).val();

                                            let product_id = $(".product-id-" + index).val();
                                            let product_price = $("#product-price").val();

                                            let product_pid = $(".product-pid-" + index).val();
                                            let product_image = $(".product-image-" + index).val();
                                            let product_stock = $(".product-stock-" + index).val();

											console.log("product_pid:", product_pid);
                                            console.log("quantity:", quantity);
                                            console.log("Title:", product_title);
                                            console.log("Price:", product_price);
                                            console.log("Id:", product_id);
                                            console.log("Pid:", product_pid);
                                            console.log("Image:", product_image);
                                            console.log("Index:", index);
                                            console.log("stock:", product_stock);
                                            console.log("Current Element:", this_val);

                                            $.ajax({
                                                url: '/add-to-cart',
                                                data:{
                                                    'id': product_id,
                                                    'pid': product_pid,
                                                    'image': product_image,
                                                    'qty': quantity,
                                                    'title': product_title,
                                                    'price': product_price,
                                                    'stock': product_stock,
                                                },
                                                dataType: 'json',
                                                beforeSend: function(){
                                                    console.log("Adding Product to cart...");
                                                },
                                                success: function(response){
                                                    this_val.html("✔")
                                                    console.log("Added Product to Cart!");
                                                    $(".cart-items-count").text(response.totalcartitems);
                                                }
                                            });
                                        });
                                    });
                                </script>

	<!--Start of Tawk.to Script-->
<script type="text/javascript">
var Tawk_API=Tawk_API||{}, Tawk_LoadStart=new Date();
(function(){
var s1=document.createElement("script"),s0=document.getElementsByTagName("script")[0];
s1.async=true;
s1.src='https://embed.tawk.to/5ac1aabb4b401e45400e4197/default';
s1.charset='UTF-8';
s1.setAttribute('crossorigin','*');
s0.parentNode.insertBefore(s1,s0);
})();
</script>
  <script>
        // Script để gửi đường dẫn ảnh cho hàm glass_try khi click vào nút Try Glass
        const productImage = $(".product-item-image").val();
        document.getElementById('glass_try').addEventListener('click', function() {
            fetch("{% url 'core:glass_try' %}?glass_image_path=" + productImage)
                .then(response => response.json())
                .then(data => {
                    console.log(data);
                })
                .catch(error => console.error(error));
        });
    </script>

<script>
    document.addEventListener("DOMContentLoaded", function() {
        var addToCartButton = document.getElementById("add-to-cart-btn-btn-btn");
        var stockCount = {{ p.stock_count }};
        var stockCountElement = document.getElementById("stock-count");

        if (stockCount === 0) {
            addToCartButton.disabled = true; // Vô hiệu hóa nút
               stockCountElement.textContent = "Sold out"; // Thay đổi nội dung của thẻ h5
               stockCountElement.style.color = "red";
               stockCountElement.style.fontWeight = "bold";
        }
    });
</script>


<!--End of Tawk.to Script-->
 </body>



</html>






 {% endblock content %}